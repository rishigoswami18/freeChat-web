@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== Safe Area for notched phones ===== */
.safe-area-top {
  padding-top: env(safe-area-inset-top, 0px);
}

.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

/* ===== Stream Chat Core Layout ===== */
.str-chat {
  height: 100%;
  width: 100%;
  --str-chat__primary-color: oklch(var(--p));
  --str-chat__active-primary-color: oklch(var(--pf));
  --str-chat__surface-color: oklch(var(--b1));
  --str-chat__secondary-surface-color: oklch(var(--b2));
  --str-chat__primary-surface-color-low-emphasis: oklch(var(--b3));
  --str-chat__border-radius-circle: 9999px;
  font-family: inherit;
}

.str-chat-channel,
.str-chat__channel,
.str-chat__container,
.str-chat__main-panel {
  height: 100%;
  width: 100%;
}

.str-chat__main-panel {
  display: flex;
  flex-direction: column;
}

/* ===== Message List ===== */
.str-chat__list {
  padding: 12px;
  background: transparent;
}

@media (min-width: 640px) {
  .str-chat__list {
    padding: 16px;
  }
}

.str-chat__list-notifications {
  display: none;
}

/* ===== Message Input ===== */
.str-chat__message-input {
  border-top: 1px solid oklch(var(--b3));
  padding: 8px 12px;
  background: oklch(var(--b1));
}

@media (min-width: 640px) {
  .str-chat__message-input {
    padding: 12px 16px;
  }
}

.str-chat__input-flat {
  border-radius: 24px;
}

/* ===== Message Bubble Styling ===== */
.str-chat__message-simple-text-inner {
  border-radius: 18px !important;
}

/* ===== Hide default channel header (we use custom) ===== */
.str-chat__header-livestream {
  display: none;
}

/* ===== Emotion Badge Animation ===== */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(4px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.stream-message-wrapper .animate-badge {
  animation: fadeInUp 0.3s ease-out;
}

/* ========================================
   VIDEO CALL PAGE 
   ======================================== */

.call-page-theme {
  height: 100vh;
  width: 100vw;
}

.call-page {
  display: flex;
  flex-direction: column;
  height: 100vh;
  width: 100vw;
  /* Use dvh for mobile browsers that hide the address bar */
  height: 100dvh;
  background: #0f0f0f;
  overflow: hidden;
}

/* Header bar */
.call-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(12px);
  z-index: 10;
}

@media (min-width: 640px) {
  .call-header {
    padding: 12px 24px;
  }
}

.call-header-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.call-status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #22c55e;
  box-shadow: 0 0 8px #22c55e;
  animation: pulse-dot 2s ease-in-out infinite;
}

@keyframes pulse-dot {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.5;
  }
}

.call-status-text {
  color: rgba(255, 255, 255, 0.7);
  font-size: 13px;
  font-weight: 500;
}

@media (min-width: 640px) {
  .call-status-text {
    font-size: 14px;
  }
}

/* Video area â€” takes all remaining space */
.call-video-area {
  flex: 1;
  min-height: 0;
  position: relative;
}

/* Make Stream's speaker layout fill the area */
.call-video-area .str-video__speaker-layout {
  height: 100% !important;
  width: 100% !important;
}

.call-video-area .str-video__speaker-layout__wrapper {
  height: 100% !important;
}

.call-video-area .str-video__speaker-layout__spotlight {
  height: 100% !important;
  border-radius: 0 !important;
}

.call-video-area .str-video__participant-view {
  border-radius: 0 !important;
}

/* Participant bar at bottom */
.call-video-area .str-video__speaker-layout__participants-bar {
  padding: 4px 8px;
  gap: 6px;
}

@media (min-width: 640px) {
  .call-video-area .str-video__speaker-layout__participants-bar {
    padding: 8px 16px;
    gap: 8px;
  }
}

.call-video-area .str-video__speaker-layout__participants-bar .str-video__participant-view {
  border-radius: 8px !important;
  overflow: hidden;
  min-width: 80px;
  max-width: 120px;
}

@media (min-width: 640px) {
  .call-video-area .str-video__speaker-layout__participants-bar .str-video__participant-view {
    border-radius: 12px !important;
    min-width: 140px;
    max-width: 180px;
  }
}

/* Controls bar */
.call-controls-bar {
  display: flex;
  justify-content: center;
  padding: 10px 12px;
  padding-bottom: calc(10px + env(safe-area-inset-bottom, 0px));
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(12px);
}

@media (min-width: 640px) {
  .call-controls-bar {
    padding: 16px 24px;
  }
}

/* Style the call control buttons */
.call-controls-bar .str-video__call-controls {
  gap: 8px;
}

@media (min-width: 640px) {
  .call-controls-bar .str-video__call-controls {
    gap: 12px;
  }
}

.call-controls-bar .str-video__call-controls__button {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.1);
  transition: all 0.2s ease;
}

@media (min-width: 640px) {
  .call-controls-bar .str-video__call-controls__button {
    width: 48px;
    height: 48px;
  }
}

.call-controls-bar .str-video__call-controls__button:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.08);
}

/* End call button in red */
.call-controls-bar .str-video__end-call-button {
  background: #ef4444 !important;
  border-color: #ef4444 !important;
}

.call-controls-bar .str-video__end-call-button:hover {
  background: #dc2626 !important;
  transform: scale(1.08);
}

/* Video placeholder / avatar */
.str-video__participant-view__avatar {
  background: #1a1a2e !important;
}

/* Name tag on video */
.str-video__participant-details {
  background: rgba(0, 0, 0, 0.6) !important;
  backdrop-filter: blur(8px);
  border-radius: 8px !important;
  padding: 4px 10px !important;
}

/* ===== Mobile-specific touch improvements ===== */
@media (max-width: 639px) {

  /* Larger tap targets on mobile */
  .btn-sm {
    min-height: 36px;
    min-width: 36px;
  }

  /* Prevent text selection on interactive elements */
  button,
  a,
  .btn {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }

  /* Smoother scrolling on mobile */
  html {
    -webkit-overflow-scrolling: touch;
  }
}